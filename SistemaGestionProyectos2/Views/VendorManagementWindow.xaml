<!-- VendorManagementWindow.xaml - Estilo consistente con PayrollManagementView -->
<Window x:Class="SistemaGestionProyectos2.Views.VendorManagementWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Gestión de Vendedores" 
        Height="800" 
        Width="1400"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal">

    <Window.Resources>
        <!-- Colores consistentes con el resto del proyecto -->
        <SolidColorBrush x:Key="PrimaryColor" Color="#6366F1"/>
        <SolidColorBrush x:Key="PrimaryLight" Color="#E0E7FF"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#10B981"/>
        <SolidColorBrush x:Key="SuccessLight" Color="#D1FAE5"/>
        <SolidColorBrush x:Key="DangerColor" Color="#EF4444"/>
        <SolidColorBrush x:Key="DangerLight" Color="#FEE2E2"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F59E0B"/>
        <SolidColorBrush x:Key="InfoColor" Color="#3B82F6"/>
        <SolidColorBrush x:Key="BackgroundGray" Color="#F9FAFB"/>
        <SolidColorBrush x:Key="BorderGray" Color="#E5E7EB"/>
        <SolidColorBrush x:Key="TextGray" Color="#6B7280"/>
        <SolidColorBrush x:Key="DarkText" Color="#111827"/>

        <!-- Estilo para DataGrid consistente con el proyecto -->
        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderGray}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="{StaticResource BorderGray}"/>
            <Setter Property="RowHeight" Value="60"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="CanUserReorderColumns" Value="False"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="CanUserAddRows" Value="False"/>
            <Setter Property="CanUserDeleteRows" Value="False"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="AlternatingRowBackground" Value="{StaticResource BackgroundGray}"/>
            <Setter Property="RowStyle">
                <Setter.Value>
                    <Style TargetType="DataGridRow">
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#F3F4F6"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{StaticResource PrimaryLight}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Setter Property="ColumnHeaderStyle">
                <Setter.Value>
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{StaticResource BackgroundGray}"/>
                        <Setter Property="Foreground" Value="{StaticResource TextGray}"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="FontSize" Value="12"/>
                        <Setter Property="Height" Value="48"/>
                        <Setter Property="Padding" Value="16,0"/>
                        <Setter Property="BorderBrush" Value="{StaticResource BorderGray}"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Estilo para botones -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryColor}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Opacity" Value="0.9"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="SecondaryButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="White"/>
            <Setter Property="Foreground" Value="{StaticResource DarkText}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderGray}"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>

        <Style x:Key="SuccessButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="{StaticResource SuccessColor}"/>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="{StaticResource DangerColor}"/>
        </Style>
    </Window.Resources>

    <Grid Background="{StaticResource BackgroundGray}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" BorderThickness="0,0,0,1" 
                BorderBrush="{StaticResource BorderGray}">
            <Grid Margin="30,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="👥" FontSize="24" Margin="0,0,12,0" 
                             VerticalAlignment="Center"/>
                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Gestión de Vendedores" 
                                 FontSize="24" FontWeight="Light"
                                 Foreground="{StaticResource DarkText}"/>
                        <TextBlock Text="Administración de usuarios y comisiones" 
                                 FontSize="13" 
                                 Foreground="{StaticResource TextGray}"/>
                    </StackPanel>
                </StackPanel>

                <Button Grid.Column="2" Content="← Volver al menú" 
                        Style="{StaticResource SecondaryButton}"
                        Click="CloseButton_Click"/>
            </Grid>
        </Border>

        <!-- Barra de herramientas -->
        <Border Grid.Row="1" Background="White" Padding="30,15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Botones de acción -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Button Name="AddVendorButton"
                            Style="{StaticResource SuccessButton}"
                            Click="AddVendor_Click"
                            Margin="0,0,10,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="➕" FontSize="14" Margin="0,0,8,0"/>
                            <TextBlock Text="Nuevo Vendedor"/>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <!-- Búsqueda -->
                <Border Grid.Column="2" BorderBrush="{StaticResource BorderGray}" 
                        BorderThickness="1" CornerRadius="8" Width="300"
                        Background="White">
                    <Grid>
                        <TextBox Name="SearchBox" BorderThickness="0" 
                                Padding="35,10,10,10" FontSize="14"
                                Background="Transparent"
                                VerticalContentAlignment="Center"
                                TextChanged="SearchBox_TextChanged"/>
                        <TextBlock Text="🔍" FontSize="14" Margin="10,0,0,0"
                                 HorizontalAlignment="Left" VerticalAlignment="Center"
                                 Foreground="{StaticResource TextGray}" IsHitTestVisible="False"/>
                        <TextBlock Text="Buscar vendedor..." 
                                 FontSize="14" Margin="35,0,0,0"
                                 HorizontalAlignment="Left" VerticalAlignment="Center"
                                 Foreground="{StaticResource TextGray}" IsHitTestVisible="False">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Text, ElementName=SearchBox}" Value="">
                                            <Setter Property="Visibility" Value="Visible"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Grid>
                </Border>
            </Grid>
        </Border>

        <!-- Tabla de vendedores -->
        <Border Grid.Row="2" Margin="30,20,30,20" Background="White" 
                CornerRadius="12" Padding="0">
            <Border.Effect>
                <DropShadowEffect Color="#000000" Direction="270" 
                                ShadowDepth="2" Opacity="0.08" BlurRadius="10"/>
            </Border.Effect>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Título de la tabla -->
                <Border Grid.Row="0" Background="{StaticResource BackgroundGray}" 
                        CornerRadius="12,12,0,0" Padding="20,15">
                    <Grid>
                        <TextBlock Text="VENDEDORES ACTIVOS" 
                                 FontSize="14" FontWeight="Bold"
                                 Foreground="{StaticResource DarkText}"/>
                        <TextBlock Name="VendorCountText" 
                                 HorizontalAlignment="Right"
                                 FontSize="13" Foreground="{StaticResource TextGray}"/>
                    </Grid>
                </Border>

                <!-- DataGrid -->
                <DataGrid Grid.Row="1" Name="VendorsDataGrid"
                          Style="{StaticResource ModernDataGrid}"
                          SelectionChanged="VendorsDataGrid_SelectionChanged">
                    <DataGrid.Columns>
                        <!-- Avatar y Nombre -->
                        <DataGridTemplateColumn Header="VENDEDOR" Width="2*" MinWidth="200">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Margin="16,0">
                                        <Border Width="36" Height="36" CornerRadius="18" Margin="0,0,12,0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                    <GradientStop Color="#667EEA" Offset="0"/>
                                                    <GradientStop Color="#764BA2" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock Text="{Binding AvatarInitial}" 
                                                     FontSize="14" Foreground="White"
                                                     HorizontalAlignment="Center" 
                                                     VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel VerticalAlignment="Center">
                                            <TextBlock Text="{Binding VendorName}" 
                                                     FontSize="14" FontWeight="SemiBold"
                                                     Foreground="{StaticResource DarkText}"/>
                                            <TextBlock Text="{Binding Username}" 
                                                     FontSize="12" 
                                                     Foreground="{StaticResource PrimaryColor}"/>
                                        </StackPanel>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- Email -->
                        <DataGridTextColumn Header="EMAIL" 
                                          Binding="{Binding Email}"
                                          Width="1.5*"
                                          MinWidth="150">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Margin" Value="16,0"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextGray}"/>
                                    <Setter Property="FontSize" Value="13"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Teléfono -->
                        <DataGridTextColumn Header="TELÉFONO" 
                                          Binding="{Binding Phone}"
                                          Width="*"
                                          MinWidth="120">
                            <DataGridTextColumn.ElementStyle>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Margin" Value="16,0"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                    <Setter Property="Foreground" Value="{StaticResource TextGray}"/>
                                    <Setter Property="FontSize" Value="13"/>
                                </Style>
                            </DataGridTextColumn.ElementStyle>
                        </DataGridTextColumn>

                        <!-- Comisión Editable -->
                        <DataGridTemplateColumn Header="COMISIÓN" Width="120">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border Background="{StaticResource BackgroundGray}"
                                           CornerRadius="4" Margin="16,0" Padding="8,4">
                                        <TextBox Text="{Binding CommissionRate, StringFormat='{}{0:F1}%'}"
                                               FontSize="14" FontWeight="Bold"
                                               Foreground="{StaticResource PrimaryColor}"
                                               Background="Transparent" BorderThickness="0"
                                               HorizontalAlignment="Center"
                                               PreviewMouseDown="CommissionTextBox_PreviewMouseDown"
                                               KeyDown="CommissionTextBox_KeyDown"
                                               LostFocus="CommissionTextBox_LostFocus"
                                               Tag="{Binding}"
                                               IsReadOnly="True"/>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!-- Acciones -->
                        <DataGridTemplateColumn Header="ACCIONES" Width="200">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                        <Button Content="✏️ Editar"
                                              Background="{StaticResource PrimaryColor}"
                                              Foreground="White"
                                              BorderThickness="0"
                                              Padding="10,6"
                                              Margin="0,0,8,0"
                                              FontSize="12"
                                              Cursor="Hand"
                                              Click="EditButton_Click"
                                              Tag="{Binding}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                          CornerRadius="6"
                                                          Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Opacity" Value="0.9"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>

                                        <Button Content="🗑️ Desactivar"
                                              Background="{StaticResource DangerColor}"
                                              Foreground="White"
                                              BorderThickness="0"
                                              Padding="10,6"
                                              FontSize="12"
                                              Cursor="Hand"
                                              Click="DeactivateButton_Click"
                                              Tag="{Binding}">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                          CornerRadius="6"
                                                          Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center"
                                                                        VerticalAlignment="Center"/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Opacity" Value="0.9"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Button.Template>
                                        </Button>
                                    </StackPanel>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>

        <!-- Toast de Notificación -->
        <Border Grid.Row="3" Name="ToastNotification" 
               Visibility="Collapsed" Background="{StaticResource DarkText}"
               CornerRadius="8" Margin="30,10" Padding="15,10"
               HorizontalAlignment="Left">
            <StackPanel Orientation="Horizontal">
                <TextBlock Name="ToastIcon" Text="✓" FontSize="14" 
                         Foreground="White" Margin="0,0,8,0"/>
                <TextBlock Name="ToastMessage" Text="Cambios guardados" 
                         FontSize="13" Foreground="White"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>